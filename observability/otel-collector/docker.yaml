# Docker: container logs collection

receivers:
  filelog/docker:
    include: [/var/lib/docker/containers/*/*.log]
    exclude: [/var/lib/docker/containers/*/config.v2.json]
    include_file_path: true
    storage: file_storage
    start_at: beginning
    operators:
      # Parse Docker json-file format
      - type: json_parser
        timestamp:
          parse_from: attributes.time
          layout: '%Y-%m-%dT%H:%M:%S.%LZ'
      - type: regex_parser
        id: extract_container_id
        parse_from: attributes["log.file.path"]
        regex: '/var/lib/docker/containers/(?P<container_id>[a-f0-9]+)/'
      - type: move
        from: attributes.container_id
        to: resource["container.id"]
      - type: move
        from: attributes.stream
        to: attributes["log.iostream"]
      - type: move
        from: attributes.log
        to: body
      - type: remove
        field: attributes.time
